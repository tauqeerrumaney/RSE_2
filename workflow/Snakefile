include: "rules/preprocessing.smk"
include: "rules/analysis.smk"
include: "rules/output.smk"


# Define the shell command to use for all rules
shell.prefix("set -euo pipefail; ")


# Load the configuration file
configfile: "config/config.yaml"


# Default rule to create the report
rule all:
    input:
        "results/report.pdf",


# Visualize the workflow
rule plot_dag:
    input:
        "workflow/Snakefile",
    output:
        "workflow_dag.png",
    log:
        "logs/plot_dag.stderr",
    conda:
        "envs/plot_dag.yaml"
    shell:
        """
        snakemake -c 1 --dag | dot -Tpng -o {output} 2> {log}
        """
